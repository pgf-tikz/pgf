% Copyright 2011 by Jannis Pohlmann
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
%
% See the file doc/generic/pgf/licenses/LICENSE for more details.

\ProvidesFileRCS[v\pgfversion] $Header$

\usepgflibrary{graphdrawing}
\usetikzlibrary{graphs}
\usetikzlibrary{graphdrawing}


%
% General options for changing the orientation and component packing
% of graph drawings.
%
\tikzgraphsset{
  graph drawing/register key=orientation,
  graph drawing/register key=orientation',
  graph drawing/register node key=desired at, % TODO: this should be a coordinate key
  %
  orient/.code={
    \tikz@gd@parse@orient{#1}{normal}
  },
  orient'/.code={
    \tikz@gd@parse@orient{#1}{swapped}
  },
}



\def\tikz@gd@parse@orient#1#2{
  \pgfutil@in@:{#1}%
  \ifpgfutil@in@%
    \tikz@gd@parse@orient@angle#1\pgf@stop{#2}%
  \else%
    \pgfutil@in@-{#1}%
    \ifpgfutil@in@%
      \tikz@gd@parse@orient@horiz#1\pgf@stop{#2}%
    \else%
      \edef\pgf@temp{#1}%
      \expandafter\tikz@gd@parse@orient@vert\pgf@temp\pgf@stop{#2}%
    \fi%
  \fi%
}

\def\tikz@gd@parse@orient@horiz#1-#2\pgf@stop#3{
  \pgfkeys{/tikz/graphs/graph drawing/@options/.append={orientation}{{#1}{#2}{0}{#3}}}%
}

\def\tikz@gd@parse@orient@vert#1|#2\pgf@stop#3{
  \pgfkeys{/tikz/graphs/graph drawing/@options/.append={orientation}{{#1}{#2}{-90}{#3}}}%
}

\def\tikz@gd@parse@orient@angle#1:#2:#3\pgf@stop#4{
  \pgfmathsetmacro{\tikz@gd@temp}{#2}%
  \edef\tikz@gd@temp{/tikz/graphs/graph drawing/@options/.append={orientation}{{#1}{#3}{\tikz@gd@temp}{#4}}}%
  \expandafter\pgfkeys\expandafter{\tikz@gd@temp}%
}



%
% Experimental layout style for trying new ideas.
%
\tikzgraphsset{
  experimental layout/.style={
    graph drawing engine,
    algorithm=experimental,
    initial positioning=circle,
  }
}



%
% Common options for the spring and spring-electrical algorithm.
%
\tikzgraphsset{
  %
  % Graph options
  %
  graph drawing/register key=initial positioning,
  graph drawing/register math key=natural spring dimension,
  graph drawing/register key=spring stiffness,
  graph drawing/register key=monotonic energy minimization,
  graph drawing/register math key=influence cutoff distance,
  graph drawing/register key=maximum iterations,
  graph drawing/register key=random seed,
  graph drawing/register key=coarsening,
  graph drawing/register key=minimum energy delta,
  graph drawing/register node coordinate key=at,
  %
  % Node options
  %
  % graph drawing/register node key=electric charge,
  graph drawing/register node key=nail at,% TODO: this should be a coordinate key
  %
  % Edge options
  %
}



%
% Spring graph drawing algorithm.
% 
\tikzgraphsset{
  spring layout/.style={
    graph drawing engine,
    algorithm=standard spring electrical,
    initial positioning=random,
  }
}



%
% Spring graph drawing algorithm.
% 
\tikzgraphsset{
  spring electrical layout/.style={
    graph drawing engine,
    %algorithm=standard spring electrical,
    algorithm=walshaw spring electrical,
    coarsening=true,
    initial positioning=random,
    random seed=42, % TODO set to 42 by default
  }
}



%%
%% Example of how to register graph, node and edge keys 
%% as well as how to create graph, node and edge styles.
%%
%\tikzgraphsset{
%  graph drawing/register node key=my dummy node key,
%  graph drawing/register node math key=my dummy node math key,
%  graph drawing/register edge key=my dummy edge key,
%  graph drawing/register edge math key=my dummy edge math key,
%  % Graph style
%  my dummy tree/.style={
%    graph drawing engine,
%    algorithm=whetherelltree
%  },
%  % Node style
%  my dummy node/.style={
%    my dummy node key=foo,
%    fill=yellow
%  },
%  % Edge style (needs to registered differently)
%  graph drawing/register edge style={%
%    my dummy edge/.style={
%      color=blue,
%      my dummy edge math key=2cm
%    }
%  }
%}

\endinput
