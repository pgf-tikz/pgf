\ProvidesPackageRCS[v\pgfversion] $Header$

% Copyright 2005 by Till Tantau <tantau@cs.tu-berlin.de>.
%
% This program can be redistributed and/or modified under the terms
% of the GNU Public License, version 2.




% A snake for connecting circle nodes
%
% Parameters: \pgfsnakecirclestartradius, \pgfsnakecircleendradius, \pgflinewidth

\pgfdeclaresnake{circle connection bar}{initial}
{
  \state{initial}[width=0pt,next state=bar]
  {
    {
    \pgftransformxshift{-1pt}%
    \pgftransformxshift{-\pgfsnakecirclestartradius}%
    \pgfpathmoveto{\pgfpointpolar{\pgfsnakesegmentangle}{\pgfsnakecirclestartradius}}
    \pgfpatharc{\pgfsnakesegmentangle}{-\pgfsnakesegmentangle}{\pgfsnakecirclestartradius}
    \@tempcnta=-\pgfsnakesegmentangle\relax
    \advance\@tempcnta by90\relax
    \@tempdima=\pgfsnakecirclestartradius\relax
    \pgfpathcurveto
    {\pgfpointadd
      {\pgfpointpolar{-\pgfsnakesegmentangle}{\pgfsnakecirclestartradius}}
      {\pgfpointpolar{\the\@tempcnta}{.25\@tempdima}}}
    {\pgfpoint{1.25\@tempdima}{-.5\pgflinewidth}}
    {\pgfpoint{1.5\@tempdima}{-.5\pgflinewidth}}
    \pgfpathlineto{\pgfpoint{1.5\@tempdima}{.5\pgflinewidth}}
    \@tempcnta=\pgfsnakesegmentangle\relax
    \advance\@tempcnta by-90\relax
    \pgfpathcurveto
    {\pgfpoint{1.25\@tempdima}{.5\pgflinewidth}}
    {\pgfpointadd
      {\pgfpointpolar{\pgfsnakesegmentangle}{\pgfsnakecirclestartradius}}
      {\pgfpointpolar{\the\@tempcnta}{.25\@tempdima}}}
    {\pgfpointpolar{\pgfsnakesegmentangle}{\pgfsnakecirclestartradius}}
    \pgfpathclose
    }
  }
  \state{bar}[width=0pt,next state=end]
  {
    \@tempdima=\pgfsnakecirclestartradius\relax
    \@tempdimb=\pgfsnakecircleendradius\relax
    \pgfpathrectangle
    {\pgfpoint{.5\@tempdima-1pt}{-.5\pgflinewidth}}
    {\pgfpoint{\pgfsnakeremainingdistance-.5\@tempdimb-.5\@tempdima+2pt}{\pgflinewidth}}
  }
  \state{end}[width=0pt,next state=final]
  {
    {
    \pgftransformxshift{\pgfsnakeremainingdistance}%
    \pgftransformxshift{1pt}%
    \pgftransformxscale{-1}%
    \pgftransformxshift{-\pgfsnakecircleendradius}%
    \pgfpathmoveto{\pgfpointpolar{\pgfsnakesegmentangle}{\pgfsnakecircleendradius}}
    \pgfpatharc{\pgfsnakesegmentangle}{-\pgfsnakesegmentangle}{\pgfsnakecircleendradius}
    \@tempcnta=-\pgfsnakesegmentangle\relax
    \advance\@tempcnta by90\relax
    \@tempdima=\pgfsnakecircleendradius\relax
    \pgfpathcurveto
    {\pgfpointadd
      {\pgfpointpolar{-\pgfsnakesegmentangle}{\pgfsnakecircleendradius}}
      {\pgfpointpolar{\the\@tempcnta}{.25\@tempdima}}}
    {\pgfpoint{1.25\@tempdima}{-.5\pgflinewidth}}
    {\pgfpoint{1.5\@tempdima}{-.5\pgflinewidth}}
    \pgfpathlineto{\pgfpoint{1.5\@tempdima}{.5\pgflinewidth}}
    \@tempcnta=\pgfsnakesegmentangle\relax
    \advance\@tempcnta by-90\relax
    \pgfpathcurveto
    {\pgfpoint{1.25\@tempdima}{.5\pgflinewidth}}
    {\pgfpointadd
      {\pgfpointpolar{\pgfsnakesegmentangle}{\pgfsnakecircleendradius}}
      {\pgfpointpolar{\the\@tempcnta}{.25\@tempdima}}}
    {\pgfpointpolar{\pgfsnakesegmentangle}{\pgfsnakecircleendradius}}
    \pgfpathclose
    }
  }
  \state{final}
  {}
}


\def\pgfsnakesegmentangle{20}

\pgfdeclarehorizontalshading[current]{bar}{100bp}{%
  color(0pt)=(neutral.bg);
  color(30bp)=(neutral.bg);
  color(70bp)=(current);
  color(100bp)=(current)}

\definecolor{neutral.bg}{rgb}{0.7,0.7,0.71}
\colorlet{neutral.fg}{black}

\newcommand\externalnode[3]{
  \node[text=black,fill=neutral.bg,scale=1.5] (#1) at (#2) {\textsc{#3}};
}


\newcommand\satellitevarchain[4]{
  \node[text=neutral.fg,fill=neutral.bg,scale=2,outer sep=-1pt] (#2) at ([shift=(#3:15cm)]#1) {\textsc{#4}};

  \def\pgfsnakecirclestartradius{7cm}
  \def\pgfsnakecircleendradius{3.5cm}
  \fill [neutral.bg,line width=12mm,snake=circle connection bar] (#1) -- (#2);
}

\newcommand\satellitevar[5]{
  \node[text=#5.fg,fill=#5.bg,scale=2,outer sep=-1pt] (#2) at ([shift=(#3:15cm)]#1) {\textsc{#4}};

  \def\pgfsnakecirclestartradius{3.5cm}
  \def\pgfsnakecircleendradius{3.5cm}
  \colorlet{current}{#5.bg}
  \shade [shading=bar,shading angle=#3,line width=12mm,snake=circle connection bar] (#1) -- (#2);
}


\newcommand\satellitevarcont[4]{
  \node[text=neutral.fg,fill=neutral.bg,scale=2,outer sep=-1pt] (#2) at ([shift=(#3:10cm)]#1) {\textsc{#4}};

  \def\pgfsnakecirclestartradius{3.5cm}
  \def\pgfsnakecircleendradius{3.5cm}

  \fill [color=neutral.bg,line width=12mm,snake=circle connection bar] (#1) -- (#2);
}



\newcommand\satellite[3]{
  \node[text=#1.fg,fill=#1.bg,scale=2,outer sep=-1pt] (#1) at (#2:21cm) {\textsc{#3}};

  \def\pgfsnakecirclestartradius{7cm}
  \def\pgfsnakecircleendradius{3.5cm}
  \colorlet{current}{#1.bg}
  \shade [shading=bar,shading angle=#2,line width=12mm,snake=circle connection bar] (informatics) -- (#1);
}


\newcommand\subsatellite[4]{
  \begin{scope}[shift=(#1.center)]
    \node[text=black,fill=#1.bg,scale=1.5] (#2) at (#3:8.5cm) {#4};

    \def\pgfsnakecirclestartradius{3.5cm}
    \def\pgfsnakecircleendradius{2.625cm}

    \fill [fill=#1.bg,line width=8mm,snake=circle connection bar] (#1) -- (#2);
  \end{scope}
}


\newcommand\subsubsatellite[5]{
  \begin{scope}[shift=(#2.center)]
    \node[text=black,fill=#1.bg] (#3) at (#4:7cm) {#5};

    \def\pgfsnakecirclestartradius{2.625cm}
    \def\pgfsnakecircleendradius{1.75cm}

    \fill [fill=#1.bg,line width=4mm,snake=circle connection bar] (#2) -- (#3);
  \end{scope}
}
  

\newcommand\subsubsubsatellite[5]{
  \begin{scope}[shift=(#2.center)]
    \node[text=black,fill=#1.bg,scale=.7] (#3) at (#4:5cm) {\Large #5};

    \def\pgfsnakecirclestartradius{1.75cm}
    \def\pgfsnakecircleendradius{1.225cm}

    \fill [fill=#1.bg,line width=2mm,snake=circle connection bar] (#2) -- (#3);
  \end{scope}
}



\newcommand\lecture[7]{
  \node (lecture-#3)
  [%
    #1,
    shape=rectangle,
    minimum size=0pt,
    text width=7.4cm,
    outer sep=2mm,
    inner sep=2mm,
    text badly ragged,
    fill=#6!20,
    rounded corners,
    scale=.5,
  ] at (#2) 
  {%
    \hbox to 7.4cm{\textcolor{blue}{\strut{#3\kern1ex}#4}\hfil}%
    \par
    \small
    \def\item{\par\leavevmode \llap{\textcolor{blue}{\textbullet}\kern1ex}}
    \leavevmode\kern4mm%
    \begin{minipage}[t]{7cm}
      \kern-1em
      \raggedright
      #5\par
    \end{minipage}%
  };

  \node [%
    xshift=-6pt,%
    yshift=-6pt,%
    shape=rectangle,%
    text width=6pt,%
    minimum size=0pt,%
    outer sep=0mm,
    inner sep=0pt,
    below left] at (lecture-#3.north east) 
    {%
      \def\currentlecture{#7}%
      \edef\lecturebase{\lectureprefix-beamer_version.pdf}%
      \expandafter\href\expandafter{\lecturebase}%
      {%
        \tikz[scale=.75,rounded corners=0pt]
        {
          \fill[blackprime!20]  (0pt,0pt) rectangle (6pt,6pt);
          \fill[blue!50]   (6pt,0pt) rectangle (8pt,6pt);
          \draw[blackprime!75]  (0pt,0pt) rectangle (8pt,6pt);
        }%
      }%
    };
    
  \node [%
    xshift=-6pt,%
    yshift=-12pt,%
    shape=rectangle,%
    text width=4pt,%
    minimum size=0pt,
    outer sep=0mm,
    inner sep=0pt,
    below left] at (lecture-#3.north east)
    {%
      \def\currentlecture{#7}%
      \edef\lecturebase{\lectureprefix-article_version.pdf}%
      \expandafter\href\expandafter{\lecturebase}%
      {%
        \tikz[scale=.6666,rounded corners=0pt]
        {
          \filldraw[fill=yellow!60!black!30,draw=blackprime!75]
          (0pt,0pt)  -- (0pt,8pt) -- (4pt,8pt) --
          (6pt,6pt)  -- (6pt,0pt) -- cycle;
          \draw[blackprime!75]  (4pt,8pt)  |- (6pt,6pt);
        }%
      }%
    };%
}


\endinput