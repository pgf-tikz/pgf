\input regression-test.tex

\OMIT

\newbox\PGFTESTBOX

\def\BEGINPGFTEST#1{%
  \BEGINTEST{pgf: #1}%
  \setbox\PGFTESTBOX=\hbox\bgroup
    \pgfpicture
}

\def\ENDPGFTEST{%
    \endpgfpicture
  \egroup
  \begingroup
    \showboxbreadth=\maxdimen
    \showboxdepth=\maxdimen
    \showbox\PGFTESTBOX
  \endgroup
  \ENDTEST
}

\def\BEGINTIKZTEST#1{%
  \BEGINTEST{tikz: #1}%
  \setbox\PGFTESTBOX=\hbox\bgroup
    \tikzpicture
}

\def\ENDTIKZTEST{%
    \endtikzpicture
  \egroup
  \begingroup
    \showboxbreadth=\maxdimen
    \showboxdepth=\maxdimen
    \showbox\PGFTESTBOX
  \endgroup
  \ENDTEST
}

% more typeout commands
\def\PASSED {\TYPE{PASSED}}
\def\FAILED {\TYPE{FAILED}}
\long\def\FAILEDAT#1{\TYPE{FAILED at #1}}

% more assert commands, which if fails will typeout more diagnostic info
\protected\long\def\AssertEquals#1#2{%
  \ifx#1#2%
    \PASSED
  \else
    \FAILEDAT{\string\AssertEquals\detokenize{{#1}{#2}}}%
    \TYPE{%
      - Expected:            \meaning#1^^J%
      - Actual: \space\space \meaning#2%
    }%
  \fi
}

\TIMO
