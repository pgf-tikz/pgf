\documentclass{minimal}
\input{pgf-regression-test}
\RequirePackage{fp,pgf,tikz,xcolor}

\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar,shapes.misc}
\usetikzlibrary{calendar,shapes.misc}
\usetikzlibrary{calendar}
\usetikzlibrary{calendar}

\begin{document}

\BEGINBOXTEST{pgfmanual-en-library-calendar-1}
\tikz \calendar[dates=2000-01-01 to 2000-01-31,week list];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-2}
\tikz \calendar[dates=2000-01-01 to 2000-01-31,week list,day xshift=3ex];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-3}
\tikz \calendar[dates=2000-01-01 to 2000-01-31,week list,day yshift=2ex];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-4}
\tikz \calendar[dates=2000-01-01 to 2000-02-last,week list,
                month yshift=0pt];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-5}
\tikz \calendar[dates=2000-01-01 to 2000-02-last,week list,
                month yshift=1cm];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-6}
\begin{tikzpicture}
  \draw[help lines] (0,0) grid (3,2);
  \matrix [anchor=cal-2000-01-20.center] at (2,2)
  { \calendar(cal)[dates=2000-01-01 to 2000-01-31,week list]; \\};
\end{tikzpicture}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-7}
\tikz \calendar[dates=2000-01-01 to 2000-01-31,week list,
                day code={\fill[blue] (0,0) circle (2pt);}];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-9}
\begin{tikzpicture}
  \calendar (mycal) [dates=2000-01-01 to 2000-01-31,week list];

  \draw[red] (mycal-2000-01-20) circle (4pt);
\end{tikzpicture}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-10}
\tikz \calendar[dates=2000-01-01 to 2000-01-31,week list,
                day text=x];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-11}
\tikz \calendar[dates=2000-01-01 to 2000-01-31,week list,
                day text=\%d0];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-12}
\tikz[every day/.style=red]
  \calendar[dates=2000-01-01 to 2000-01-31,week list];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-13}
\tikz \calendar[dates=2000-01-01 to 2000-02-last,week list,
                month label above centered];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-15}
\tikz \calendar[dates=2000-01-01 to 2000-01-31,week list,
                month label above centered,
                month text=\textcolor{red}{\%mt} \%y-];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-16}
\tikz
  \calendar
    [dates=2000-01-01 to 2000-01-31,week list]
    if (Sunday) [red];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-17}
\tikz
  \calendar
    [dates=2000-01-01 to 2000-01-31,week list]
    if (Sunday)            [red]
    if (equals=2000-01-20) {\draw (0,0) circle (8pt);};
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-18}
\tikz [every day/.style={anchor=mid}]
  \calendar
    [dates=2000-01-01 to 2000-01-31,week list]
    if (Sunday)            [red]
    if (equals=2000-01-20) {\draw (0,0) circle (8pt);};
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-19}
\tikz
  \calendar [dates=2000-01-01 to 2000-01-08,
             execute after day scope=
               {\pgftransformyshift{-1em}}];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-20}
\tikz
  \calendar
    [dates=2000-01-01 to 2000-01-08,
     execute after day scope={\pgftransformyshift{-1em}},
     execute at begin day scope=
       {\ifdate{day of month=1}{\tikzmonthcode}{}},
     every month/.append style={anchor=base east,xshift=-2em}];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-21}
\tikz
  \calendar
    [dates=2000-01-01 to 2000-01-20,
     % each day is shifted right according to the day of week
     execute at begin day scope=
       {\pgftransformxshift{\pgfcalendarcurrentweekday em}},
     % after each week, the origin is shifted downward:
     execute after day scope=
       {\ifdate{Sunday}{\pgftransformyshift{-1em}}{}}];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-22}
\newcount\mycount
\tikz
  \calendar
    [dates=2000-01-01 to 2000-02-last,
     execute before day scope=
     {
       \ifdate{day of month=1} {
         % Remember the weekday of first day of month
         \mycount=\pgfcalendarcurrentweekday
         % Shift downward
         \pgftransformyshift{-1em}
       }{}
     },
     execute at begin day scope=
     {
       % each day is shifted right according to the day of month
       \pgftransformxshift{\pgfcalendarcurrentday em}
       % and additionally according to the weekday of the first
       \pgftransformxshift{\the\mycount em}
     }];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-23}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list downward,month yshift=1em];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-24}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list upward,month yshift=1em];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-25}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list right,month xshift=1em];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-26}
\tikz
  \calendar [dates=2000-01-01 to 2000-02-last,week list];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-27}
\tikz
  \calendar [dates=2000-01-01 to 2000-02-last,week list,
             month yshift=0pt];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-28}
\sffamily\scriptsize
\tikz
  \calendar [dates=2000-01-01 to 2000-12-31,
             month list,month label left,month yshift=1.25em]
            if (Sunday) [black!50];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-29}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list downward,month yshift=1em,
             month label left];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-30}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list downward,month yshift=1em,
             month label left vertical];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-31}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list downward,month yshift=1em,
             month label right];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-32}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list downward,month yshift=1em,
             month label right vertical];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-33}
\tikz
  \calendar [dates=2000-01-28 to 2000-02-03,
             day list right,month xshift=1em,
             month label above left];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-34}
\tikz
  \calendar [dates=2000-01-20 to 2000-02-10,
             week list,month label above left];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-35}
\tikz
  \calendar [dates=2000-02-01 to 2000-02-last,
             day list right,month label above centered];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-36}
\tikz
  \calendar [dates=2000-01-20 to 2000-02-10,
             week list,month label above centered];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-37}
\tikz
  \calendar [dates=2000-01-20 to 2000-02-10,
             week list,month label above right];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-38}
\tikz
  \calendar [dates=2000-02-01 to 2000-02-last,
             day list right,month label below left];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-39}
\tikz
  \calendar [dates=2000-02-01 to 2000-02-last,
             day list right,month label below centered];
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-40}
\begin{tikzpicture}
  \calendar
  [
    dates=2099-12-01 to 2100-01-last,
    week list,inner sep=2pt,month label above centered,
    month text=\%mt \%y0
  ]
  if (at most=2099-12-29) [nodes={strike out,draw}]
  if (weekend)            [black!50,nodes={draw=none}]
  ;
\end{tikzpicture}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-41}
\begin{tikzpicture}
  \calendar
  [
    dates=\year-\month-\day+-25 to \year-\month-\day+25,
    week list,inner sep=2pt,month label above centered,
    month text=\textit{\%mt \%y0}
  ]
  if (at least=\year-\month-\day) {}
    else [nodes={strike out,draw}]
  if (at most=\year-\month-\day+7)
    [green!50!black]
  if (between=\year-\month-\day+8 and \year-\month-\day+10)
    [red]
  if (Sunday)
    [gray,nodes={draw=none}]
  ;
\end{tikzpicture}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-42}
\sffamily

\colorlet{winter}{blue}
\colorlet{spring}{green!60!black}
\colorlet{summer}{orange}
\colorlet{fall}{red}

\newcount\mycount

\begin{tikzpicture}
  [transform shape,
   every day/.style={anchor=mid,font=\fontsize{6}{6}\selectfont}]
  \node{\normalsize\the\year};
  \foreach \month/\monthcolor in
    {1/winter,2/winter,3/spring,4/spring,5/spring,6/summer,
     7/summer,8/summer,9/fall,10/fall,11/fall,12/winter}
  {
    % Compute angle:
    \mycount=\month
    \advance\mycount by -1
    \multiply\mycount by 30
    \advance\mycount by -90

    % The actual calendar
    \calendar at (\the\mycount:6.4cm)
    [
      dates=\the\year-\month-01 to \the\year-\month-last,
    ]
    if (day of month=1) {\color{\monthcolor}\tikzmonthcode}
    if (Sunday) [red]
    if (all)
    {
      % Again, compute angle
      \mycount=1
      \advance\mycount by -\pgfcalendarcurrentday
      \multiply\mycount by 11
      \advance\mycount by 90
      \pgftransformshift{\pgfpointpolar{\mycount}{1.4cm}}
    };
  }
\end{tikzpicture}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-calendar-43}
\begin{tikzpicture}
  \small\sffamily
  \colorlet{darkgreen}{green!50!black}
  \calendar[dates=\year-01-01 to \year-12-31,week list,
            month label left,month yshift=0pt,
            month text=\textcolor{darkgreen}{\%m0}]
           if (Sunday) [black!50];
\end{tikzpicture}
\ENDBOXTEST
\END
