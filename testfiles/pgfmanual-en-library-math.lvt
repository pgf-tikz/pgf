\documentclass{minimal}
\input{pgf-regression-test}
\RequirePackage{fp,pgf,tikz,xcolor}

\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}
\usetikzlibrary{math}

\begin{document}

\BEGINBOXTEST{pgfmanual-en-library-math-1}
\tikzmath{
  % Adapted from http://www.cs.northwestern.edu/academics/courses/110/html/fib_rec.html
  function fibonacci(\n) {
    if \n == 0 then {
      return 0;
    } else {
       return fibonacci2(\n, 0, 1);
     };
  };
  function fibonacci2(\n, \p, \q) {
    if \n == 1 then {
      return \q;
    } else {
      return fibonacci2(\n-1, \q, \p+\q);
    };
  };
  int \f, \i;
  for \i in {0,1,...,20} {
    \f = fibonacci(\i);
    print {\f, };
  };
}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-2}
\tikz[x=0.25cm,y=0.25cm,
  evaluate={
    int \i, \j;
    for \i in {0,...,10} {
      for \j in {0,...,10} {
        \a{\i,\j} = (\i+\j)*5;
      };
    };
  }
]
\foreach \i in {0,...,10}
  \foreach \j in {0,...,10}
    \fill [red!\a{\i,\j}!yellow]  (\i,\j) rectangle ++(1, 1);
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-3}
\newcount\mycount
\newdimen\mydimen
\tikzmath{
  \a = 4*5+6;
  \b = sin(30)*4;
  \mycount = log10(2048) / log10(2);
  \mydimen = 15^2;
}
\a, \b, \the\mycount, \the\mydimen
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-4}
\tikzmath{
  \x1 = 3+4; \x2 = 30+40; \x3 = 300+400;
}
\x1, \x2, \x3
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-5}
\tikzmath{
  \c{air} = 340; \c{water} = 1435; \c{steel} = 6100;
}
\foreach \medium in {air,steel}{The speed of sound in \medium\ is \c{\medium} m/s. }
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-6}
\tikzmath{
  let \x = (5*4)+1;
  let \c1 = blue;
}
\x, ``\c1''
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-7}
\tikzmath{
  integer \x;
  \x1 = 3+4; \x2 = 30+40; \x3 = 300+400;
}
\x1, \x2, \x3
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-8}
\tikzmath{
   integer \x, \y, \z;
   \x = 4*5+6;
   \y = sin(30)*4;
   \z = log10(512) / log10(2);
   print {$x=\x$, $y=\y$, $z=\z$};
}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-9}
\tikzmath{
   coordinate \c;
   \c = (45:10pt);
}
\tikz\draw (0,0) -- (\c);
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-10}
\tikzmath{
   coordinate \c, \d;
   \c = (-1,2)+(1,-1);
   \d = (4,1)-(2,-1);
}
\tikz\draw (\c) -- (\d);
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-11}
\tikzmath{
   coordinate \c;
   \c1 = (30:20pt);
   \c2 = (210:20pt);
}
\tikz\draw (\cx1,\cy1) -- (\cx2,\cy1) -- (\cx2,\cy2) -- (\cx1,\cy2);
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-12}
\pgfmathsetseed{1}
\tikzmath{
  int \x, \v;
  \v=1;
  for \x in {1,...,{random(3,10)}} {
     \v=\v*2;
  };
  print {$x=\x, v=\v$};
}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-13}
\tikzmath{
  int \x, \y;
  \y = 0;
  for \x1 in {1,...,5} {
    for \x2 in {10,20,...,50} {
      \y = \y+\x1*\x2;
    };
  };
}
$x_1=\x1, x_2=\x2, y=\y$
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-14}
\begin{tikzpicture}
  \tikzmath{
    int \x;
    for \k in {0,10,...,350} {
      if \k>260 then { let \c = orange; } else {
        if \k>170 then { let \c = blue; } else {
          if \k>80 then { let \c = red; } else {
            let \c = green; }; }; };
      {
        \path [fill=\c!50, draw=\c] (\k:0.5cm) -- (\k:1cm) --
          (\k+5:1cm) -- (\k+5:0.5cm) -- cycle;
      };
    };
  }
  \end{tikzpicture}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-15}
\pgfmathsetseed{1}
\tikzmath{
  function product(\x,\y) {
    return \x*\y;
  };
  int \i, \j, \k;
  \i = random(1,10);
  \j = random(20, 40);
  \k = product(\i, \j);
  print { $\i\times \j = \k$ };
}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-16}
\pgfmathsetseed{1}
\tikzmath{
  int \x, \y, \z;
  \x = random(2, 5);
  for \y in {0,...,6} {
    \z = \x^\y;
    print {$\x^\y=\z$, };
  };
}
\ENDBOXTEST

\BEGINBOXTEST{pgfmanual-en-library-math-17}
\begin{tikzpicture}
\draw [help lines] grid (3,2);
\tikzmath{
  coordinate \c;
  for \x in {0,10,...,360} {
    \c = (1.5cm, 1cm) + (\x:1cm and 0.5cm);
    { \fill (\c) circle [radius=1pt]; };
  };
}
\end{tikzpicture}
\ENDBOXTEST
\END
