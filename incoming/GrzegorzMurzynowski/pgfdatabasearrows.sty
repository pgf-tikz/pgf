% A~definition of some database entity diagram arrow tips for
% pgf (tikz) based on arrow declaration tips in the Till Tantau's pgf
% manual for v1.10 p.\ 254.
%
% author: Natror (Grzegorz Murzynowski), natror at o2.pl
% 2006/12/16
%
% This file is a~draft version intended to be possibly adjusted by the
% tikz package developer(s) and included into the tikz bundle 
% on the Gnu Public License.
%
% 
% 

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{pgfdatabasearrows}

\RequirePackage{tikz}
\RequirePackage{pgflibraryarrows}


\newdimen\arrowsize

% nulla
\pgfarrowsdeclare{nulla}{nulla}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfarrowsleftextend{-.5\pgflinewidth}
  \pgfarrowsrightextend{3\arrowsize+.5\pgflinewidth}
}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfsetdash{}{0pt} % do not dash
  \pgfsetroundjoin
  \pgfsetroundcap
  \pgfpathmoveto{\pgfpointorigin}
  \pgfpathlineto{\pgfpoint{3\arrowsize}{0\arrowsize}}
  \pgfusepathqstroke
}

% nulla = dbplain
\pgfarrowsdeclarealias{dbplain}{dbplain}{nulla}{nulla}


% nullalonga
\pgfarrowsdeclare{nullalonga}{nullalonga}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfarrowsleftextend{-.5\pgflinewidth}
  \pgfarrowsrightextend{5.5\arrowsize+.5\pgflinewidth}
}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfsetdash{}{0pt} % do not dash
  \pgfsetroundjoin
  \pgfsetroundcap
  \pgfpathmoveto{\pgfpointorigin}
  \pgfpathlineto{\pgfpoint{5.5\arrowsize}{0\arrowsize}}
  \pgfusepathqstroke
}

% nullalonga = dbplainlong
\pgfarrowsdeclarealias{dbplainlong}{dbplainlong}{nullalonga}{nullalonga}


% dboshortt
\pgfarrowsdeclarecombine*[-.5\pgflinewidth]%offset
{dboshortt}{dboshortt}{o}{o}{nulla}{nulla}

% dboshort
\pgfarrowsdeclarecombine*[-.5\pgflinewidth]%offset
{dboshort}{dboshort}{o}{o}{nullalonga}{nullalonga}

% dbo
\pgfarrowsdeclarecombine*[-1\pgflinewidth]%offset
{dbo}{dbo}{dboshort}{dboshort}{nulla}{nulla}

% dbolong
\pgfarrowsdeclarecombine*[-1\pgflinewidth]%offset
{dbolong}{dbolong}{dboshort}{dboshort}{nullalonga}{nullalonga}

% dbbar for nice combining
\pgfarrowsdeclare{dbbar}{dbbar}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfarrowsleftextend{-.5\pgflinewidth}
  \pgfarrowsrightextend{.5\pgflinewidth}
}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfsetdash{}{0pt} % do not dash
  \pgfsetroundjoin
  \pgfsetroundcap
  \pgfpathmoveto{\pgfpoint{0\arrowsize}{6\arrowsize}}
  \pgfpathlineto{\pgfpoint{0\arrowsize}{-6\arrowsize}}
  \pgfusepathqstroke
}

% db1
\pgfarrowsdeclarecombine*[-.5\pgflinewidth]%offset
{db1}{db1}{dbbar}{dbbar}{nulla}{nulla}

% dbo1,  starred to avoid stroking the o
\pgfarrowsdeclarecombine*[-.5\pgflinewidth]%offset
{dbo1}{dbo1}{dboshortt}{dboshortt}{db1}{db1}

% db1o, * not to stroke |- in tight curves 
\pgfarrowsdeclarecombine*[-.5\pgflinewidth]%offset
{db1o}{db1o}{db1}{db1}{dboshortt}{dboshortt}

% dbmany
\pgfarrowsdeclare{dbmany}{dbmany}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfarrowsleftextend{-.5\pgflinewidth}
  \pgfarrowsrightextend{10.4\arrowsize+.5\pgflinewidth}
}
{
  \arrowsize=0.2pt
  \advance\arrowsize by .5\pgflinewidth
  \pgfsetdash{}{0pt} % do not dash
  \pgfsetroundjoin
  \pgfsetroundcap
  \pgfpathmoveto{\pgfpointorigin}
  \pgfpathlineto{\pgfpoint{10.4\arrowsize}{6\arrowsize}}
  \pgfusepathqstroke
  \pgfpathmoveto{\pgfpointorigin}
  \pgfpathlineto{\pgfpoint{10.4\arrowsize}{0\arrowsize}}
  \pgfusepathqstroke
  \pgfpathmoveto{\pgfpointorigin}
  \pgfpathlineto{\pgfpoint{10.4\arrowsize}{-6\arrowsize}}
  \pgfusepathqstroke
}

% dbomany
\pgfarrowsdeclarecombine*[-1.5\pgflinewidth]%offset
{dbomany}{dbomany}{dboshortt}{dboshortt}{dbmany}{dbmany}


\endinput